=IF(ISBLANK([Due Date]),"Missing Due date","<img src='/_layouts/images/blank.gif' onload=""{"&"    var SPday=new Date();"&"    SPday.setFullYear("&YEAR([Due Date])&","&MONTH([Due Date])-1&","&DAY([Due Date])&");"&"    var Days=Math.round((SPday.getTime()-new Date().getTime())/86400000);"&"    var Range=[ -365*20 , -365*10 , -365*5 , 0 , 7 , 14 , 21 ];"&"    var CSS=['white', 'white', 'white', '#FF4646', 'white', 'white', 'white'];"&"    for (var i=0;i<Range.length;i++){var Color=CSS[i];if(Days<Range[i]){break}}"&"    var TR=this;while(TR.tagName!='TR'){TR=TR.parentNode}"&"    TR.style.backgroundColor=Color;"&"TR.style.color='black';"&"    this.parentNode.innerHTML=Math.abs(Days)+' days '+((Days<0)?'past':'left');"&"}"">")